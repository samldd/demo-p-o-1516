<!DOCTYPE html>
<html>

<head>
    <title>P&O student-assistent site</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/font-autumn.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/site.css') }}">

    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="pragma" content="no-cache" />


    <script>
    var drive_accelerometer = false;

    function drive_accelerometer_button(){
        drive_accelerometer=!drive_accelerometer;
        if(drive_accelerometer){
            document.getElementById('endis').innerHTML = ' disable accelerometer';
        }
        else{
            document.getElementById('endis').innerHTML = ' enable accelerometer';
        }
    }


    if (window.DeviceOrientationEvent) {
		window.addEventListener("deviceorientation", function(event)
		{

			var xValue = Math.round(event.gamma);
			var yValue = Math.round(event.beta);
			var rotation = Math.round(event.alpha);
            document.getElementById("accelerometer").innerHTML = "accelerometer data: xValue: " + xValue + "; yValue: " + yValue + "; rotation: " + rotation;

            //send accelerometer data
            var site = '/acc?xValue='+xValue+'&yValue='+yValue;
            someimg = new Image();
            someimg.src = site;


            var c = document.getElementById("a_graph");
            var ctx = c.getContext("2d");

            ctx.clearRect(0,0,c.width,c.height);

            ctx.font="12(px Georgia";
            ctx.fillText("yValue",120,70);
            ctx.fillText("80",140,90);
            ctx.fillText("-80",10,90);
            ctx.fillText("xValue",85,10);
            ctx.fillText("-80",55,10);
            ctx.fillText("80",60,150);

            ctx.fillStyle = 'grey';
            ctx.fillText("FORWARD",54,30);
            ctx.fillText("BACKWARD",50,130);
            ctx.fillText("LEFT",10,100);
            ctx.fillText("RIGHT",120,100);

            ctx.rect(0, 0, 160, 160);
            ctx.stroke();
            ctx.rect(70, 70, 20, 20);
            ctx.stroke();
            ctx.rect(0, 80, 160, 0);
            ctx.stroke();
            ctx.rect(80, 0, 0, 160);
            ctx.stroke();

            ctx.beginPath();
            ctx.arc(yValue+80,xValue+80,5,0,2*Math.PI);
            ctx.stroke();
		}, true);
	} else {
	    //alert("Sorry, your browser doesn't support Device Orientation");
	}
    </script>
</head>

<body>
<div class ="wrapper">
    <div class ="box" style="padding: 5px;"><h1>P&amp;O demo 2015-2016</h1></div>
        <div id="upperrightbox" class="box">
            <h1>Manual controls</h1>
            <a class="btn" href="javascript:drive_accelerometer_button();"><i id="endis" class="icon-flag-checkered"> enable accelerometer</i></a>
            <table width="100%">
                <tr width="100%"><td>
                    <table>
                        <tr>
                            <td></td>
                            <td><a class="btn" href="javascript:document.querySelector('input[value=forward]').click();"><i class="icon-arrow-circle-up"></i></a></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td><a class="btn" href="javascript:document.querySelector('input[value=left]').click();"><i class="icon-arrow-circle-left"></i></a></td>
                            <td><a class="btn" href="javascript:document.querySelector('input[value=backward]').click();"><i class="icon-arrow-circle-down"></i></a></td>
                            <td><a class="btn" href="javascript:document.querySelector('input[value=right]').click();"><i class="icon-arrow-circle-right"></i></a></td>
                        </tr>
                        <tr><td colspan="3"><a class="btn" href="javascript:document.querySelector('input[value=stopdriving]').click();"><i class="icon-flag-checkered"></i> brake</a></td></tr>
                    </table>
                    <br>


                    <!--
                    <a class="btn" href="javascript:document.querySelector('input[value=picture]').click();"><i class="icon-camera"></i> Take picture</a>
                    <a class="btn" href="javascript:document.querySelector('input[value=stream]').click();"><i class="icon-video-camera"></i> stream</a>
                    -->
                </td>
                <td style="text-align: right">
                    <p id="accelerometer"></p>
                    <canvas id="a_graph" width="200" height="200">
                        This text is displayed if your browser does not support HTML5 Canvas.
                    </canvas>
                </td></tr>
            </table>
        </div>
    </div>
</div>


<form method="post" target="response_iframe">
    <input type="submit" name="submit" value="left" style="display:none">
    <input type="submit" name="submit" value="backward" style="display:none">
    <input type="submit" name="submit" value="right" style="display:none">
    <input type="submit" name="submit" value="forward" style="display:none">

    <input type="submit" name="submit" value="stopdriving" style="display:none">
</form>
</body>

</html>
